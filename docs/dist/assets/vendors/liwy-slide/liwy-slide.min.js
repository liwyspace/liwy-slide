/*! liwy-slide - v1.0.0 - 2017-08-24
* https://github.com/liwyspace/liwy-slide#readme
* Copyright (c) 2017 liwy; Licensed MIT */

!function(t,i,s,o){var e=function(i,s){this.$element=t(i),this.options=t.extend({},e.defaults,s),this.viewport=null,this.loader=null,this.children=null,this.controls={},this.pagerEl=null,this.active={},this.working=!1,this.animProp=null,this.usingCSS=!1,this.init()};e.defaults={wrapperClass:"liwy-wrapper",mode:"horizontal",slideSelector:"",randomStart:!1,startSlide:0,slideZIndex:50,captions:!0,useCSS:!1,slideMargin:0,slideWidth:0,moveSlides:0,controls:!0,nextText:"Next",prevText:"Prev",nextSelector:null,prevSelector:null,autoControls:!0,startText:"Start",stopText:"Stop",autoControlsCombine:!0,autoControlsSelector:null,pager:!0,pagerSelector:null,pagerCustom:null,buildPager:null,auto:!0,autoStart:!1},e.prototype.init=function(){this.children=this.$element.children(this.options.slideSelector),this.options.randomStart&&(this.options.startSlide=Math.floor(Math.random()*this.children.length)),this.active={index:this.options.startSlide},this.working=!1,this.animProp="vertical"===this.options.mode?"top":"left",this.usingCSS=this.options.useCSS&&"fade"!==this.options.mode&&function(){for(var t=s.createElement("div"),i=["WebkitPerspective","MozPerspective","OPerspective","msPerspective"],o=0;o<i.length;o++)if(void 0!==t.style[i[o]])return this.cssPrefix=i[o].replace("Perspective","").toLowerCase(),this.animProp="-"+this.cssPrefix+"-transform",!0;return!1}(),this.setup()},e.prototype.setup=function(){this.$element.wrap('<div class="'+this.options.wrapperClass+'"><div class="liwy-viewport"></div></div>'),this.viewport=this.$element.parent(),this.loader=t('<div class="liwy-loading" />'),this.viewport.prepend(this.loader),console.log(this);this.viewport.parent().css({maxWidth:"100%"}),this.viewport.css({width:"100%",overflow:"hidden",position:"relative"}),this.$element.css({width:"horizontal"===this.options.mode?1e3*this.children.length+"%":"auto",position:"relative"}),this.children.css({float:"horizontal"===this.options.mode?"left":"none",listStyle:"none",position:"relative"});var i=this.options.slideWidth,s=this.viewport.width();("vertical"===this.options.mode||0===this.options.slideWidth||this.options.slideWidth>s)&&(i=s),console.log(i),this.children.css("width",i),"horizontal"===this.options.mode&&this.options.slideMargin>0&&this.children.css("marginRight",this.options.slideMargin),"vertical"===this.options.mode&&this.options.slideMargin>0&&this.children.css("marginBottom",this.options.slideMargin),"fade"===this.options.mode&&(this.children.css({position:"absolute",zIndex:0,display:"none"}),this.children.eq(this.options.startSlide).css({zIndex:this.options.slideZIndex,display:"block"}),this.viewport.css({height:"200px"})),this.options.captions&&this.children.each(function(i){var s=t(this).find("img:first").attr("title");void 0!==s&&(""+s).length&&t(this).append('<div class="liwy-caption"><span>'+s+"</span></div>")}),this.controls.element=t('<div class="liwy-controls" />'),this.options.controls&&(this.controls.next=t('<a class="liwy-next" href="">'+this.options.nextText+"</a>"),this.controls.prev=t('<a class="liwy-prev" href="">'+this.options.prevText+"</a>"),this.controls.next.bind("click touchend",t.proxy(function(t){t.preventDefault(),this.controls.element.hasClass("disabled")||this.goToNextSlide()},this)),this.controls.prev.bind("click touchend",t.proxy(function(t){t.preventDefault(),this.controls.element.hasClass("disabled")||this.goToPrevSlide()},this)),this.options.nextSelector&&t(this.options.nextSelector).append(this.controls.next),this.options.prevSelector&&t(this.options.prevSelector).append(this.controls.prev),this.options.nextSelector||this.options.prevSelector||(this.controls.directionEl=t('<div class="liwy-controls-direction" />'),this.controls.directionEl.append(this.controls.prev).append(this.controls.next),this.controls.element.addClass("liwy-has-controls-direction").append(this.controls.directionEl))),this.options.auto&&this.options.autoControls&&(this.controls.start=t('<div class="liwy-controls-auto-item"><a class="liwy-start" href="">'+this.options.startText+"</a></div>"),this.controls.stop=t('<div class="liwy-controls-auto-item"><a class="liwy-stop" href="">'+this.options.stopText+"</a></div>"),this.controls.autoEl=t('<div class="liwy-controls-auto" />'),this.controls.autoEl.on("click",".liwy-start",t.proxy(function(t){this.startAuto(),t.preventDefault()},this)),this.controls.autoEl.on("click",".liwy-stop",t.proxy(function(t){this.stopAuto(),t.preventDefault()},this)),this.options.autoControlsCombine?this.controls.autoEl.append(this.controls.start):this.controls.autoEl.append(this.controls.start).append(this.controls.stop),this.options.autoControlsSelector?t(this.options.autoControlsSelector).html(this.controls.autoEl):this.controls.element.addClass("liwy-has-controls-auto").append(this.controls.autoEl),this.updateAutoControls(this.options.autoStart?"stop":"start")),this.options.pager&&(this.options.pagerCustom?this.pagerEl=t(this.options.pagerCustom):(this.pagerEl=t('<div class="liwy-pager" />'),this.options.pagerSelector?t(this.options.pagerSelector).html(this.pagerEl):this.controls.element.addClass("liwy-has-pager").append(this.pagerEl),this.populatePager()),this.pagerEl.on("click touchend","a",t.proxy(function(i){var s,o;i.preventDefault(),this.controls.element.hasClass("disabled")||void 0!==(s=t(i.currentTarget)).attr("data-slide-index")&&(o=parseInt(s.attr("data-slide-index")))!==this.active.index&&this.goToSlide(o)},this))),console.log(this.options.controls),(this.options.controls||this.options.autoControls||this.options.pager)&&this.viewport.after(this.controls.element),this.start()},e.prototype.start=function(){this.loader.remove(),this.options.pager&&this.updatePagerActive(this.options.startSlide),this.options.controls&&this.updateDirectionControls()},e.prototype.goToSlide=function(t,i){var s,o,e={left:0,top:0};this.oldIndex=this.active.index;var n=t;t<0?n=this.active.index:t>=this.getPagerQty()&&(n=this.active.index),this.active.index=n,this.active.last=this.active.index>=this.getPagerQty()-1,this.working||this.active.index===this.oldIndex||(this.working=!0,(this.options.pager||this.options.pagerCustom)&&this.updatePagerActive(this.active.index),this.options.controls&&this.updateDirectionControls(),"fade"===this.options.mode||(t>=0&&(o=t*parseInt(this.getMoveBy()),e=this.children.eq(o).position()),void 0!==e&&(s="horizontal"===this.options.mode?-(e.left-0):-e.top,this.setPositionProperty(s,"slide",this.options.speed)),this.working=!1))},e.prototype.goToNextSlide=function(){if(1!=this.working){var t=parseInt(this.active.index)+1;this.goToSlide(t,"next")}},e.prototype.goToPrevSlide=function(){if(1!=this.working){var t=parseInt(this.active.index)-1;this.goToSlide(t,"prev")}},e.prototype.startAuto=function(t){this.options.autoControls&&!0!==t&&this.updateAutoControls("stop")},e.prototype.stopAuto=function(t){this.options.autoControls&&!0!==t&&this.updateAutoControls("start")},e.prototype.getMoveBy=function(){return this.options.moveSlides>0&&this.options.moveSlides<=this.getNumberSlidesShowing()?this.options.moveSlides:this.getNumberSlidesShowing()},e.prototype.updateAutoControls=function(t){console.log(t),this.options.autoControlsCombine?this.controls.autoEl.html(this.controls[t]):(this.controls.autoEl.find("a").removeClass("active"),this.controls.autoEl.find("a:not(.liwy-"+t+")").addClass("active"))},e.prototype.populatePager=function(){for(var i="",s="",o=this.getPagerQty(),e=0;e<o;e++)s="",this.options.buildPager&&t.isFunction(this.options.buildPager)||this.options.pagerCustom?(s=this.options.buildPager(e),this.pagerEl.addClass("liwy-custom-pager")):(s=e+1,this.pagerEl.addClass("liwy-default-pager")),i+='<div class="liwy-pager-item"><a href="" data-slide-index="'+e+'" class="liwy-pager-link">'+s+"</a></div>";this.pagerEl.html(i)},e.prototype.getPagerQty=function(){var t=0;return this.options.moveSlides>0||(t=Math.ceil(this.children.length/this.getNumberSlidesShowing())),t},e.prototype.getNumberSlidesShowing=function(){return 1},e.prototype.updatePagerActive=function(i){this.children.length;this.pagerEl.find("a").removeClass("active"),this.pagerEl.each(function(s,o){t(o).find("a").eq(i).addClass("active")})},e.prototype.updateDirectionControls=function(){1===this.getPagerQty()?(this.controls.prev.addClass("disabled"),this.controls.next.addClass("disabled")):(console.log("active index:"+this.active.index),0===this.active.index?(this.controls.prev.addClass("disabled"),this.controls.next.removeClass("disabled")):this.active.index===this.getPagerQty()-1?(this.controls.next.addClass("disabled"),this.controls.prev.removeClass("disabled")):(this.controls.prev.removeClass("disabled"),this.controls.next.removeClass("disabled")))},e.prototype.setPositionProperty=function(i,s,o,e){var n;this.usingCSS||((n={})[this.animProp]=i,"slide"===s?this.$element.animate(n,o,this.options.easing,t.proxy(function(){this.updateAfterSlideTransition()},this)):"reset"===s&&this.$element.css(this.animProp,i))},e.prototype.updateAfterSlideTransition=function(){this.working=!1},t.fn.liwySlide=function(i){return this.each(function(){var s=t(this),o=s.data("liwy.slide");o||(o=new e(this,"object"==typeof i&&i),s.data("liwy.slide",o))})}}(window.jQuery,window,document);